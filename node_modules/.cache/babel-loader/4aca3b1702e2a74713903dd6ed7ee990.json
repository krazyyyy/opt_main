{"ast":null,"code":"import * as nacl from './nacl/naclWrappers';\nimport * as address from './encoding/address';\nimport * as encoding from './encoding/encoding';\nimport * as txnBuilder from './transaction';\nimport * as LogicTemplatesCommonJSExport from './logicTemplates';\nimport Bid from './bid';\nimport * as convert from './convert';\nimport * as utils from './utils/utils';\nconst SIGN_BYTES_PREFIX = Buffer.from([77, 88]); // \"MX\"\n// Errors\nexport const MULTISIG_BAD_SENDER_ERROR_MSG = 'The transaction sender address and multisig preimage do not match.';\n/**\n * signTransaction takes an object with either payment or key registration fields and\n * a secret key and returns a signed blob.\n *\n * Payment transaction fields: from, to, amount, fee, firstRound, lastRound, genesisHash,\n * note(optional), GenesisID(optional), closeRemainderTo(optional)\n *\n * Key registration fields: fee, firstRound, lastRound, voteKey, selectionKey, voteFirst,\n * voteLast, voteKeyDilution, genesisHash, note(optional), GenesisID(optional)\n *\n * If flatFee is not set and the final calculated fee is lower than the protocol minimum fee, the fee will be increased to match the minimum.\n * @param txn - object with either payment or key registration fields\n * @param sk - Algorand Secret Key\n * @returns object contains the binary signed transaction and its txID\n */\nexport function signTransaction(txn, sk) {\n  if (typeof txn.from === 'undefined') {\n    // Get pk from sk if no sender specified\n    const key = nacl.keyPairFromSecretKey(sk);\n    // eslint-disable-next-line no-param-reassign\n    txn.from = address.encodeAddress(key.publicKey);\n  }\n  const algoTxn = txnBuilder.instantiateTxnIfNeeded(txn);\n  return {\n    txID: algoTxn.txID().toString(),\n    blob: algoTxn.signTxn(sk)\n  };\n}\n/**\n * signBid takes an object with the following fields: bidder key, bid amount, max price, bid ID, auctionKey, auction ID,\n * and a secret key and returns a signed blob to be inserted into a transaction Algorand note field.\n * @param bid - Algorand Bid\n * @param sk - Algorand secret key\n * @returns Uint8Array binary signed bid\n */\nexport function signBid(bid, sk) {\n  const signedBid = new Bid(bid);\n  return signedBid.signBid(sk);\n}\n/**\n * signBytes takes arbitrary bytes and a secret key, prepends the bytes with \"MX\" for domain separation, signs the bytes\n * with the private key, and returns the signature.\n * @param bytes - Uint8array\n * @param sk - Algorand secret key\n * @returns binary signature\n */\nexport function signBytes(bytes, sk) {\n  const toBeSigned = Buffer.from(utils.concatArrays(SIGN_BYTES_PREFIX, bytes));\n  const sig = nacl.sign(toBeSigned, sk);\n  return sig;\n}\n/**\n * verifyBytes takes array of bytes, an address, and a signature and verifies if the signature is correct for the public\n * key and the bytes (the bytes should have been signed with \"MX\" prepended for domain separation).\n * @param bytes - Uint8Array\n * @param signature - binary signature\n * @param addr - string address\n * @returns bool\n */\nexport function verifyBytes(bytes, signature, addr) {\n  const toBeVerified = Buffer.from(utils.concatArrays(SIGN_BYTES_PREFIX, bytes));\n  const pk = address.decodeAddress(addr).publicKey;\n  return nacl.verify(toBeVerified, signature, pk);\n}\n/**\n * encodeObj takes a javascript object and returns its msgpack encoding\n * Note that the encoding sorts the fields alphabetically\n * @param o - js obj\n * @returns Uint8Array binary representation\n */\nexport function encodeObj(o) {\n  return new Uint8Array(encoding.encode(o));\n}\n/**\n * decodeObj takes a Uint8Array and returns its javascript obj\n * @param o - Uint8Array to decode\n * @returns object\n */\nexport function decodeObj(o) {\n  return encoding.decode(o);\n}\nexport const ERROR_MULTISIG_BAD_SENDER = new Error(MULTISIG_BAD_SENDER_ERROR_MSG);\nexport const ERROR_INVALID_MICROALGOS = new Error(convert.INVALID_MICROALGOS_ERROR_MSG);\nexport * from './client/algod';\nexport { default as Algodv2 } from './client/v2/algod/algod';\nexport { default as Kmd } from './client/kmd';\nexport { default as IntDecoding } from './types/intDecoding';\nexport { default as Indexer } from './client/v2/indexer/indexer';\nexport { waitForConfirmation } from './wait';\nexport { isValidAddress, encodeAddress, decodeAddress, getApplicationAddress } from './encoding/address';\nexport { bytesToBigInt, bigIntToBytes } from './encoding/bigint';\nexport { encodeUint64, decodeUint64 } from './encoding/uint64';\nexport { default as generateAccount } from './account';\nimport * as modelsv2_1 from './client/v2/algod/models/types';\nexport { modelsv2_1 as modelsv2 };\nimport * as indexerModels_1 from './client/v2/indexer/models/types';\nexport { indexerModels_1 as indexerModels };\nexport { mnemonicToMasterDerivationKey, masterDerivationKeyToMnemonic, secretKeyToMnemonic, mnemonicToSecretKey, seedFromMnemonic, mnemonicFromSeed } from './mnemonic/mnemonic';\nexport { microalgosToAlgos, algosToMicroalgos, INVALID_MICROALGOS_ERROR_MSG } from './convert';\nexport { computeGroupID, assignGroupID } from './group';\nexport { LogicSigAccount, makeLogicSig, signLogicSigTransaction, signLogicSigTransactionObject, logicSigFromByte, tealSign, tealSignFromProgram } from './logicsig';\nexport { signMultisigTransaction, mergeMultisigTransactions, appendSignMultisigTransaction, createMultisigTransaction, appendSignRawMultisigSignature, verifyMultisig, multisigAddress } from './multisig';\nexport { SourceMap } from './logic/sourcemap';\nexport const LogicTemplates = LogicTemplatesCommonJSExport.default;\nexport * from './dryrun';\nexport * from './makeTxn';\nexport * from './transaction';\nexport * from './signer';\nexport * from './composer';\nexport * from './types';\nexport * from './abi';","map":{"version":3,"mappings":"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","names":["nacl","address","encoding","txnBuilder","LogicTemplatesCommonJSExport","Bid","convert","utils","SIGN_BYTES_PREFIX","Buffer","from","MULTISIG_BAD_SENDER_ERROR_MSG","signTransaction","txn","sk","key","keyPairFromSecretKey","encodeAddress","publicKey","algoTxn","instantiateTxnIfNeeded","txID","toString","blob","signTxn","signBid","bid","signedBid","signBytes","bytes","toBeSigned","concatArrays","sig","sign","verifyBytes","signature","addr","toBeVerified","pk","decodeAddress","verify","encodeObj","o","Uint8Array","encode","decodeObj","decode","ERROR_MULTISIG_BAD_SENDER","Error","ERROR_INVALID_MICROALGOS","INVALID_MICROALGOS_ERROR_MSG","default","Algodv2","Kmd","IntDecoding","Indexer","waitForConfirmation","isValidAddress","getApplicationAddress","bytesToBigInt","bigIntToBytes","encodeUint64","decodeUint64","generateAccount","modelsv2","indexerModels","mnemonicToMasterDerivationKey","masterDerivationKeyToMnemonic","secretKeyToMnemonic","mnemonicToSecretKey","seedFromMnemonic","mnemonicFromSeed","microalgosToAlgos","algosToMicroalgos","computeGroupID","assignGroupID","LogicSigAccount","makeLogicSig","signLogicSigTransaction","signLogicSigTransactionObject","logicSigFromByte","tealSign","tealSignFromProgram","signMultisigTransaction","mergeMultisigTransactions","appendSignMultisigTransaction","createMultisigTransaction","appendSignRawMultisigSignature","verifyMultisig","multisigAddress","SourceMap","LogicTemplates"],"sourceRoot":"","sources":["../../src/main.ts"],"sourcesContent":[null]},"metadata":{},"sourceType":"module"}